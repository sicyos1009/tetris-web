(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function i(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(t){if(t.ep)return;t.ep=!0;const n=i(t);fetch(t.href,n)}})();const x=document.getElementById("game"),d=x.getContext("2d"),p=10,y=20,c=32,u=Array.from({length:y},()=>Array(p).fill(0));function m(e,o,i){d.fillStyle=i===0?"#000":"#3af",d.fillRect(e*c,o*c,c,c),d.strokeStyle="#222",d.strokeRect(e*c,o*c,c,c)}function L(){for(let e=0;e<y;e++)for(let o=0;o<p;o++)m(o,e,u[e][o])}const w=[[1,1,1,1]],r={shape:w,x:3,y:0,value:1};function O(){const{shape:e,x:o,y:i,value:l}=r;for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)e[t][n]!==0&&m(o+n,i+t,l)}function f(e,o,i=null){const l=i??r.shape;for(let t=0;t<l.length;t++)for(let n=0;n<l[t].length;n++){if(l[t][n]===0)continue;const s=e+n,a=o+t;if(s<0||s>=p||a>=y||a>=0&&u[a][s]!==0)return!0}return!1}function v(e){const o=e.length,i=e[0].length,l=Array.from({length:i},()=>Array(o).fill(0));for(let t=0;t<o;t++)for(let n=0;n<i;n++)l[n][o-1-t]=e[t][n];return l}function P(){const{shape:e,x:o,y:i,value:l}=r;for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++){if(e[t][n]===0)continue;const s=i+t,a=o+n;s>=0&&s<y&&a>=0&&a<p&&(u[s][a]=l)}}function b(){for(let e=y-1;e>=0;e--)u[e].every(i=>i!==0)&&(u.splice(e,1),u.unshift(Array(p).fill(0)),e++)}function R(){if(r.shape=w,r.x=3,r.y=0,f(r.x,r.y)){alert("Game Over (임시)");for(let e=0;e<y;e++)u[e].fill(0)}}function S(){const e=r.shape,o=v(e);if(!f(r.x,r.y,o)){r.shape=o;return}if(!f(r.x-1,r.y,o)){r.x-=1,r.shape=o;return}if(!f(r.x+1,r.y,o)){r.x+=1,r.shape=o;return}r.shape=e}let h=0;const E=500;let g=0;function A(e){const o=e-g;g=e,h+=o,h>=E&&(h=0,f(r.x,r.y+1)?(P(),b(),R()):r.y+=1),d.clearRect(0,0,x.width,x.height),L(),O(),requestAnimationFrame(A)}requestAnimationFrame(A);window.addEventListener("keydown",e=>{e.key==="ArrowLeft"?f(r.x-1,r.y)||(r.x-=1):e.key==="ArrowRight"?f(r.x+1,r.y)||(r.x+=1):e.key==="ArrowDown"?f(r.x,r.y+1)||(r.y+=1):e.key==="ArrowUp"&&S()});
